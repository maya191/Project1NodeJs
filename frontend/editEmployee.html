<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <h1 id="name"></h1>
    <form>
        First Name:<input type="text" id="FirstName" /><br>
        Last Name:<input type="text" id="LastName" /><br>
        Start Work Year: <input type="number" id="StartYear"/><br>
        Department ID:<input type="text" id="DepartmentID" /><br>
        <button onclick="updateEmployee()">Update Employee</button>
        <button onclick="DeleteEmployee()">Delete Employee</button>
    </form>


    <script>
        async function updateEmployee() {
            console.log("this is function")
            const params = new URLSearchParams(window.location.search);
            console.log(params)
            // Get the employee ID from the URL
            const employeeId = params.get('id');
            console.log(employeeId)
            const FirstName=document.getElementById("FirstName").value
            const LastName=document.getElementById("LastName").value
            const StartYear=+ document.getElementById("StartYear").value
            const DepartmentID= document.getElementById("DepartmentID").value

           /*  const token = sessionStorage.getItem("token")
            if (!token) {
                window.location.href = "./login.html"
            } */
            const resp = await fetch("http://localhost:3000/editEmployee/" + employeeId, {
                method: "PUT",
                headers: {
                    "Content-Type": "application/json",
                    //"x-access-token": token
                },
                body: JSON.stringify({
                    FirstName, LastName,StartYear,DepartmentID
                })
            })
            const status = await resp.json()
            console.log(status)
            //window.location.href = "/Employee.html"
        }


         // function for deleting an employee
        async function deleteEmployee() {
            try {
                const params = new URLSearchParams(window.location.search);
                // Get the employee ID from the URL
                const employeeId = params.get('id');

                const resp = await fetch("http://localhost:3000/deleteEmployee/" + employeeId, {
                    method: "DELETE"
                });

                const status = await resp.json();
                console.log(status);

                // Uncomment the line below to redirect after successful deletion
                // window.location.href = "/Employee.html";
            } catch (error) {
                console.error('Error deleting employee:', error);
            }
        }




        

    </script>

</body>

</html>